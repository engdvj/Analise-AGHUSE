<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório Semanal AGHUSE - 30/11/2025 a 06/12/2025</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            padding: 20px;
            color: #2c3e50;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px 40px;
            border-radius: 8px 8px 0 0;
        }
        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }
        .header .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        .content {
            padding: 30px 40px;
        }
        .metrics-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        @media (min-width: 1200px) {
            .metrics-row {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .metrics-row {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .metrics-row {
                grid-template-columns: 1fr;
            }
        }
        .metric-card {
            background: #f8f9fa;
            padding: 18px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .metric-card.success { border-left-color: #27ae60; }
        .metric-card.warning { border-left-color: #f39c12; }
        .metric-card.danger { border-left-color: #e74c3c; }
        .metric-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #7f8c8d;
            margin-bottom: 6px;
            font-weight: 600;
        }
        .metric-value {
            font-size: 28px;
            font-weight: 600;
            color: #2c3e50;
            line-height: 1.2;
        }
        .metric-unit {
            font-size: 16px;
            color: #95a5a6;
            margin-left: 4px;
        }
        .chart-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }
        .chart-wrapper {
            position: relative;
            height: 350px;
        }
        /* Estilos para Abas */
        .tabs {
            display: flex;
            border-bottom: 2px solid #dee2e6;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .tab-button {
            padding: 14px 28px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: #7f8c8d;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }
        .tab-button:hover {
            color: #3498db;
            background: #f8f9fa;
        }
        .tab-button.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Estilos para cartões de análise */
        .analysis-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        .analysis-card h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: #2c3e50;
        }
        .analysis-card p {
            font-size: 14px;
            line-height: 1.6;
            color: #5a6c7d;
        }
        .anomaly-list {
            list-style: none;
            padding: 0;
        }
        .anomaly-item {
            background: white;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            border-left: 3px solid #f39c12;
        }
        .anomaly-item.high {
            border-left-color: #e74c3c;
        }
        .anomaly-timestamp {
            font-weight: 600;
            color: #2c3e50;
        }
        .anomaly-details {
            font-size: 13px;
            color: #7f8c8d;
            margin-top: 4px;
        }
        .rotas-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: white;
            border-radius: 6px;
            overflow: hidden;
        }
        .rotas-table th {
            background: #ecf0f1;
            text-align: left;
            padding: 10px 12px;
            font-size: 12px;
            text-transform: uppercase;
            color: #2c3e50;
            letter-spacing: 0.5px;
        }
        .rotas-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #dee2e6;
            font-size: 14px;
        }
        .rotas-table tr:last-child td {
            border-bottom: none;
        }
        .change-list {
            margin: 8px 0 0 16px;
            padding: 0;
        }
        .change-list li {
            margin-bottom: 4px;
            font-size: 14px;
            color: #5a6c7d;
        }
        .pagination {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        .pagination button {
            border: 1px solid #dee2e6;
            background: white;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            color: #2c3e50;
            transition: all 0.2s ease;
        }
        .pagination button:hover {
            background: #f1f3f5;
        }
        .pagination button.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .pagination {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        .pagination button {
            border: 1px solid #dee2e6;
            background: white;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            color: #2c3e50;
            transition: all 0.2s ease;
        }
        .pagination button:hover {
            background: #f1f3f5;
        }
        .pagination button.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .btn-voltar {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            margin: 20px 0;
        }

        .btn-voltar:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-voltar::before {
            content: '← ';
        }

        .back-button-container {
            text-align: center;
            padding: 20px 40px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Relatório Semanal - Monitoramento AGHUSE</h1>
            <div class="subtitle">Período: 30/11/2025 a 06/12/2025</div>
        </div>

        <div class="back-button-container">
            <a href="../index.html" class="btn-voltar">Voltar para Central de Relatórios</a>
        </div>

        <div class="content">
            <div class="metrics-row">
                <div class="metric-card success">
                    <div class="metric-label">Disponibilidade</div>
                    <div class="metric-value">99.41<span class="metric-unit">%</span></div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Latência Média (AGHUSE)</div>
                    <div class="metric-value">43.2<span class="metric-unit">ms</span></div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Latência Média (Rede Externa)</div>
                    <div class="metric-value">43.4<span class="metric-unit">ms</span></div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-label">Horários com Perda (AGHUSE)</div>
                    <div class="metric-value">20</div>
                    <div class="metric-unit" style="font-size: 14px;">(86pkt perdidos)</div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-label">Horários com Perda (Rede Externa)</div>
                    <div class="metric-value">14</div>
                    <div class="metric-unit" style="font-size: 14px;">(53pkt perdidos)</div>
                </div>
                <div class="metric-card danger">
                    <div class="metric-label">Total de Testes</div>
                    <div class="metric-value">884</div>
                </div>
            </div>

            <!-- Sistema de Abas -->
            <div class="tabs">
                <button class="tab-button active" data-tab="visao-geral">Visão Geral</button>
                <button class="tab-button" data-tab="analise-avancada">Análise Avançada</button>
                <button class="tab-button" data-tab="anomalias">Anomalias</button>
            </div>

            <!-- Aba 1: Visão Geral -->
            <div class="tab-content active" id="visao-geral">
                <div class="chart-container">
                    <div class="chart-title">Evolução da Disponibilidade por Dia</div>
                    <div class="chart-wrapper">
                        <canvas id="dispChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Evolução da Latência por Dia - AGHUSE vs Rede Externa</div>
                    <div class="chart-wrapper">
                        <canvas id="latDiaChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Latência Média por Horário - AGHUSE vs Rede Externa (Todo o Período)</div>
                    <div class="chart-wrapper">
                        <canvas id="latHoraChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Perdas por Horário - AGHUSE vs Rede Externa</div>
                    <div class="chart-wrapper">
                        <canvas id="perdasChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Aba 2: Análise Avançada -->
            <div class="tab-content" id="analise-avancada">
                <div class="chart-container">
                    <div class="chart-title">Score de Qualidade por Horário - AGHUSE vs Rede Externa (0-10)</div>
                    <div class="chart-wrapper">
                        <canvas id="scoresChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Distribuição de Latência - AGHUSE vs Rede Externa</div>
                    <div class="chart-wrapper">
                        <canvas id="distribuicaoChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Comparação por Dia da Semana</div>
                    <div class="chart-wrapper">
                        <canvas id="diasSemanaChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Aba 3: Anomalias -->
            <div class="tab-content" id="anomalias">
                <div class="analysis-card">
                    <h3>Horários de Pico</h3>
                    <p><strong>Pico Vespertino:</strong> 14h-21h (média 52.6ms, +9.5ms vs média, 8h consecutivas)</p>
                </div>

                <div class="analysis-card">
                    <h3>Análise de Rotas (Tracert)</h3>
                    <p><strong>Total de rotas detectadas:</strong> 2</p>
                    <p><strong>Correlação rota x perda:</strong> Rota principal: 8.6% de perda em 880 testes. Alternativas: 25.0% em 4 testes. Mudanças: 3 de 8 (38%) tiveram perda. Rotas alternativas mais instáveis que a principal.</p>
                    <table class="rotas-table"><thead><tr><th>Rota</th><th>Ocorrências</th><th>Com Perda</th><th>Sem Perda</th><th>Taxa de Perda</th></tr></thead><tbody><tr><td>Rota 1 (Principal) - 10.17.201.254 -> 10.17.250.114 -> ... -> 10.2.222.220 -> 10.252.17.132 (6 saltos)</td><td>880</td><td>76</td><td>804</td><td>8.6%</td></tr><tr><td>Rota 2 - 10.17.201.254 -> 10.17.250.114 -> ... -> 10.252.17.132 -> 10.252.17.132 (7 saltos)</td><td>4</td><td>1</td><td>3</td><td>25.0%</td></tr></tbody></table>
                    <p><strong>Mudanças de rota detectadas:</strong> 8 (3 com perda)</p><p>Últimas mudanças com perda:</p><ul class="change-list"><li>04/12 às 11:25: Rota 2 -> Rota 1 (Principal) (sem perda registrada; mesmos hops iniciais, 1 salto(s) a menos)</li><li>04/12 às 12:40: Rota 1 (Principal) -> Rota 2 (com perda de pacotes; mesmos hops iniciais, 1 salto(s) a mais)</li><li>04/12 às 12:45: Rota 2 -> Rota 1 (Principal) (com perda de pacotes; mesmos hops iniciais, 1 salto(s) a menos)</li><li>04/12 às 18:49: Rota 1 (Principal) -> Rota 2 (sem perda registrada; mesmos hops iniciais, 1 salto(s) a mais)</li><li>04/12 às 18:54: Rota 2 -> Rota 1 (Principal) (sem perda registrada; mesmos hops iniciais, 1 salto(s) a menos)</li></ul>
                </div>

                <div class="analysis-card">
                    <h3>Anomalias de Latência</h3>
                    <p><strong>Total de anomalias detectadas:</strong> 45</p>
                    <ul class="anomaly-list" id="anomalias-container"><li class="anomaly-item "><div class="anomaly-timestamp">04/12 às 13:44</div><div class="anomaly-details">Latência: 29ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">04/12 às 15:14</div><div class="anomaly-details">Latência: 73ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">04/12 às 17:44</div><div class="anomaly-details">Latência: 71ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">04/12 às 20:04</div><div class="anomaly-details">Latência: 54ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">04/12 às 21:29</div><div class="anomaly-details">Latência: 55ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">05/12 às 04:49</div><div class="anomaly-details">Latência: 51ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">05/12 às 05:24</div><div class="anomaly-details">Latência: 54ms - Severidade: MEDIA</div></li><li class="anomaly-item high"><div class="anomaly-timestamp">05/12 às 16:19</div><div class="anomaly-details">Latência: 68ms - Severidade: ALTA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">06/12 às 03:39</div><div class="anomaly-details">Latência: 52ms - Severidade: MEDIA</div></li><li class="anomaly-item "><div class="anomaly-timestamp">06/12 às 13:19</div><div class="anomaly-details">Latência: 51ms - Severidade: MEDIA</div></li></ul>
                    <div class="pagination" id="anomalias-pagination"><button disabled>Anterior</button><button class="active">1</button><button>2</button><button>3</button><button>4</button><button>5</button><button>Próximo</button></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        Chart.defaults.font.family = "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif";
        Chart.defaults.color = '#7f8c8d';

        // Gráfico de Disponibilidade por Dia
        new Chart(document.getElementById('dispChart'), {
            type: 'line',
            data: {
                labels: ["03/12/2025", "04/12/2025", "05/12/2025", "06/12/2025"],
                datasets: [{
                    label: 'Disponibilidade (%)',
                    data: [99.55, 99.13, 99.32, 99.77],
                    borderColor: '#27ae60',
                    backgroundColor: 'rgba(39, 174, 96, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: false, min: 98, max: 100 }
                }
            }
        });

        // Gráfico de Latência por Dia
        new Chart(document.getElementById('latDiaChart'), {
            type: 'bar',
            data: {
                labels: ["03/12/2025", "04/12/2025", "05/12/2025", "06/12/2025"],
                datasets: [
                    {
                        label: 'AGHUSE (10.252.17.132)',
                        data: [7.8, 29.8, 50.7, 51.7],
                        backgroundColor: '#3498db',
                        borderWidth: 0
                    },
                    {
                        label: 'Rede Externa (8.8.8.8)',
                        data: [45.0, 45.3, 45.7, 38.8],
                        backgroundColor: '#e74c3c',
                        borderWidth: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: { y: { beginAtZero: true } }
            }
        });

        // Gráfico de Latência por Horário - Comparativo AGHUSE vs Rede Externa
        new Chart(document.getElementById('latHoraChart'), {
            type: 'line',
            data: {
                labels: ["00h", "01h", "02h", "03h", "04h", "05h", "06h", "07h", "08h", "09h", "10h", "11h", "12h", "13h", "14h", "15h", "16h", "17h", "18h", "19h", "20h", "21h", "22h", "23h"],
                datasets: [
                    {
                        label: 'AGHUSE (10.252.17.132)',
                        data: [34.2, 36.0, 37.2, 36.2, 35.5, 36.0, 38.9, 36.4, 37.1, 37.6, 45.8, 47.4, 36.2, 38.2, 48.4, 54.9, 55.8, 54.4, 52.1, 52.1, 52.2, 51.1, 41.7, 38.9],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    },
                    {
                        label: 'Rede Externa (8.8.8.8)',
                        data: [45.1, 45.0, 45.0, 45.0, 45.1, 45.0, 45.2, 45.3, 44.7, 44.9, 43.2, 42.7, 43.1, 43.2, 43.3, 42.7, 44.2, 42.8, 40.7, 40.4, 40.6, 41.1, 41.4, 41.5],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: { y: { beginAtZero: true } }
            }
        });

        // Gráfico de Perdas por Horário - Comparativo AGHUSE vs Rede Externa
        new Chart(document.getElementById('perdasChart'), {
            type: 'bar',
            data: {
                labels: ["00h", "01h", "02h", "03h", "04h", "05h", "06h", "07h", "08h", "09h", "10h", "11h", "12h", "13h", "14h", "15h", "16h", "17h", "18h", "19h", "20h", "21h", "22h", "23h"],
                datasets: [
                    {
                        label: 'AGHUSE (10.252.17.132)',
                        data: [1, 2, 1, 0, 0, 3, 1, 2, 9, 6, 8, 14, 6, 9, 4, 5, 3, 4, 2, 0, 0, 1, 3, 2],
                        backgroundColor: '#3498db',
                        borderWidth: 0
                    },
                    {
                        label: 'Rede Externa (8.8.8.8)',
                        data: [0, 0, 0, 0, 0, 0, 1, 1, 4, 3, 3, 0, 1, 6, 1, 5, 5, 1, 0, 1, 0, 19, 0, 2],
                        backgroundColor: '#e74c3c',
                        borderWidth: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }
            }
        });

        // ============================================================
        // Gráficos das Abas Avançadas
        // ============================================================

        // Gráfico de Scores de Qualidade
        new Chart(document.getElementById('scoresChart'), {
            type: 'bar',
            data: {
                labels: ["00h", "01h", "02h", "03h", "04h", "05h", "06h", "07h", "08h", "09h", "10h", "11h", "12h", "13h", "14h", "15h", "16h", "17h", "18h", "19h", "20h", "21h", "22h", "23h"],
                datasets: [
                    {
                        label: 'Score AGHUSE',
                        data: [4.9, 3.1, 2.7, 4.6, 4.7, 4.7, 2.8, 2.5, 2.1, 2.0, 1.0, 0.9, 2.2, 1.9, 1.8, 0.8, 1.6, 1.4, 1.2, 1.7, 3.2, 4.8, 2.3, 5.8],
                        backgroundColor: '#FF8C00',
                        borderWidth: 0
                    },
                    {
                        label: 'Score Rede Externa',
                        data: [2.4, 2.2, 2.0, 2.2, 2.3, 2.2, 1.8, 2.2, 2.1, 2.0, 1.0, 0.9, 2.2, 1.9, 0.9, 0.7, 0.6, 0.7, 0.8, 0.8, 0.8, 0.8, 1.4, 1.8],
                        backgroundColor: '#DC143C',
                        borderWidth: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const score = context.parsed.y;
                                let classificacao = 'Ruim';
                                if (score >= 8.5) classificacao = 'Excelente';
                                else if (score >= 7.0) classificacao = 'Muito Bom';
                                else if (score >= 5.5) classificacao = 'Bom';
                                else if (score >= 4.0) classificacao = 'Regular';
                                return context.dataset.label + ': ' + score.toFixed(1) + ' (' + classificacao + ')';
                            }
                        }
                    }
                },
                scales: { y: { beginAtZero: true, max: 10 } }
            }
        });

        // Gráfico de Distribuição
        new Chart(document.getElementById('distribuicaoChart'), {
            type: 'bar',
            data: {
                labels: ["0-20ms", "20-40ms", "40-60ms", "60-80ms", "80+ms"],
                datasets: [
                    {
                        label: 'AGHUSE (10.252.17.132)',
                        data: [177, 2, 663, 42, 0],
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderWidth: 0
                    },
                    {
                        label: 'Rede Externa (8.8.8.8)',
                        data: [0, 161, 720, 3, 0],
                        backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        borderWidth: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'top' }
                },
                scales: { y: { beginAtZero: true } }
            }
        });

        // Gráfico Comparativo Dias da Semana
        new Chart(document.getElementById('diasSemanaChart'), {
            type: 'bar',
            data: {
                labels: ["Domingo", "Segunda", "Ter\u00e7a", "Quarta", "Quinta", "Sexta", "S\u00e1bado"],
                datasets: [
                    {
                        label: 'AGHUSE (10.252.17.132)',
                        data: [0, 0, 0, 7.8, 29.8, 50.7, 51.7],
                        backgroundColor: '#3498db',
                        borderWidth: 0
                    },
                    {
                        label: 'Rede Externa (8.8.8.8)',
                        data: [0, 0, 0, 45.0, 45.3, 45.7, 38.8],
                        backgroundColor: '#e74c3c',
                        borderWidth: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'top' }
                },
                scales: { y: { beginAtZero: true } }
            }
        });

        // ============================================================
        // Paginação de Anomalias
        // ============================================================
        const anomaliasData = [{"timestamp": "04/12 \u00e0s 13:44", "latencia": 29.0, "severidade": "media"}, {"timestamp": "04/12 \u00e0s 15:14", "latencia": 73.0, "severidade": "media"}, {"timestamp": "04/12 \u00e0s 17:44", "latencia": 71.0, "severidade": "media"}, {"timestamp": "04/12 \u00e0s 20:04", "latencia": 54.0, "severidade": "media"}, {"timestamp": "04/12 \u00e0s 21:29", "latencia": 55.0, "severidade": "media"}, {"timestamp": "05/12 \u00e0s 04:49", "latencia": 51.0, "severidade": "media"}, {"timestamp": "05/12 \u00e0s 05:24", "latencia": 54.0, "severidade": "media"}, {"timestamp": "05/12 \u00e0s 16:19", "latencia": 68.0, "severidade": "alta"}, {"timestamp": "06/12 \u00e0s 03:39", "latencia": 52.0, "severidade": "media"}, {"timestamp": "06/12 \u00e0s 13:19", "latencia": 51.0, "severidade": "media"}, {"timestamp": "06/12 \u00e0s 18:34", "latencia": 57.0, "severidade": "media"}, {"timestamp": "07/12 \u00e0s 03:19", "latencia": 56.0, "severidade": "media"}, {"timestamp": "07/12 \u00e0s 07:14", "latencia": 55.0, "severidade": "alta"}, {"timestamp": "07/12 \u00e0s 08:39", "latencia": 56.0, "severidade": "media"}, {"timestamp": "07/12 \u00e0s 09:34", "latencia": 56.0, "severidade": "media"}, {"timestamp": "07/12 \u00e0s 12:19", "latencia": 60.0, "severidade": "alta"}, {"timestamp": "07/12 \u00e0s 20:09", "latencia": 59.0, "severidade": "alta"}, {"timestamp": "07/12 \u00e0s 21:49", "latencia": 62.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 00:44", "latencia": 64.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 02:29", "latencia": 50.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 05:44", "latencia": 50.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 09:29", "latencia": 68.0, "severidade": "media"}, {"timestamp": "08/12 \u00e0s 10:59", "latencia": 66.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 14:34", "latencia": 57.0, "severidade": "media"}, {"timestamp": "08/12 \u00e0s 18:49", "latencia": 57.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 19:44", "latencia": 70.0, "severidade": "media"}, {"timestamp": "08/12 \u00e0s 20:04", "latencia": 52.0, "severidade": "alta"}, {"timestamp": "08/12 \u00e0s 23:39", "latencia": 55.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 00:09", "latencia": 56.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 01:54", "latencia": 52.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 02:54", "latencia": 52.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 05:59", "latencia": 52.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 07:34", "latencia": 70.0, "severidade": "media"}, {"timestamp": "09/12 \u00e0s 14:14", "latencia": 76.0, "severidade": "media"}, {"timestamp": "09/12 \u00e0s 15:09", "latencia": 79.0, "severidade": "media"}, {"timestamp": "09/12 \u00e0s 17:54", "latencia": 72.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 21:39", "latencia": 58.0, "severidade": "alta"}, {"timestamp": "09/12 \u00e0s 23:44", "latencia": 52.0, "severidade": "media"}, {"timestamp": "10/12 \u00e0s 03:24", "latencia": 51.0, "severidade": "media"}, {"timestamp": "10/12 \u00e0s 07:39", "latencia": 60.0, "severidade": "alta"}, {"timestamp": "10/12 \u00e0s 09:29", "latencia": 67.0, "severidade": "media"}, {"timestamp": "10/12 \u00e0s 10:49", "latencia": 62.0, "severidade": "media"}, {"timestamp": "10/12 \u00e0s 15:09", "latencia": 64.0, "severidade": "media"}, {"timestamp": "10/12 \u00e0s 23:24", "latencia": 55.0, "severidade": "alta"}, {"timestamp": "11/12 \u00e0s 00:44", "latencia": 52.0, "severidade": "media"}];
        const ANOMALIAS_PER_PAGE = 10;
        let anomaliaPage = 1;

        function renderAnomalias(page = 1) {
            const container = document.getElementById('anomalias-container');
            const pagination = document.getElementById('anomalias-pagination');
            if (!container || !pagination) return;

            const total = anomaliasData.length;
            const totalPages = Math.max(1, Math.ceil(total / ANOMALIAS_PER_PAGE));
            anomaliaPage = Math.min(Math.max(page, 1), totalPages);

            const start = (anomaliaPage - 1) * ANOMALIAS_PER_PAGE;
            const slice = anomaliasData.slice(start, start + ANOMALIAS_PER_PAGE);

            if (!slice.length) {
                container.innerHTML = '<li class="anomaly-item"><div class="anomaly-timestamp">Nenhuma anomalia detectada</div></li>';
            } else {
                container.innerHTML = slice.map(anom => {
                    const sev = (anom.severidade || 'média').toUpperCase();
                    const cls = sev === 'ALTA' ? 'high' : '';
                    const lat = typeof anom.latencia === 'number'
                        ? anom.latencia.toFixed(1).replace('.0', '')
                        : anom.latencia;
                    return `
                        <li class="anomaly-item ${cls}">
                            <div class="anomaly-timestamp">${anom.timestamp}</div>
                            <div class="anomaly-details">Latência: ${lat}ms - Severidade: ${sev}</div>
                        </li>
                    `;
                }).join('');
            }

            pagination.innerHTML = '';
            if (totalPages <= 1) return;

            const prevBtn = document.createElement('button');
            prevBtn.textContent = 'Anterior';
            prevBtn.disabled = anomaliaPage === 1;
            prevBtn.onclick = () => renderAnomalias(anomaliaPage - 1);
            pagination.appendChild(prevBtn);

            for (let i = 1; i <= totalPages; i++) {
                if (i > 3 && i < totalPages - 1 && Math.abs(i - anomaliaPage) > 2) {
                    if (i === 4 || i === totalPages - 2) {
                        const ellipsis = document.createElement('span');
                        ellipsis.textContent = '...';
                        ellipsis.style.padding = '6px 8px';
                        pagination.appendChild(ellipsis);
                    }
                    continue;
                }
                const btn = document.createElement('button');
                btn.textContent = i;
                if (i === anomaliaPage) btn.classList.add('active');
                btn.onclick = () => renderAnomalias(i);
                pagination.appendChild(btn);
            }

            const nextBtn = document.createElement('button');
            nextBtn.textContent = 'Próximo';
            nextBtn.disabled = anomaliaPage === totalPages;
            nextBtn.onclick = () => renderAnomalias(anomaliaPage + 1);
            pagination.appendChild(nextBtn);
        }

        // ============================================================
        // Sistema de Abas - Troca de Tabs
        // ============================================================
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.dataset.tab;

                // Remove active de todos
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                // Ativa o selecionado
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Render inicial das anomalias
        renderAnomalias(1);
    </script>
</body>
</html>